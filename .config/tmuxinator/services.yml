name: services
root: ~/

# Custom user services (regular files in ~/.config/systemd/user/)
# Excludes: pueued, system-provided (at-spi, evolution, org.gnome, dconf)

<%
  exclude = %w[pueued at-spi dconf evolution org.gnome]
  services = Dir.glob(File.expand_path("~/.config/systemd/user/*.service"))
    .map { |f| File.basename(f, ".service") }
    .reject { |s| exclude.any? { |e| s.start_with?(e) } }
    .sort
%>

windows:
  - monitor:
      layout: tiled
      panes:
<% services.each do |svc| %>
        - printf '\033]2;<%= svc %>\033\\'; journalctl --user -f -n 50 -u <%= svc %>.service
<% end %>
  - sysadmin:
      panes:
        - __claude_with_monitor.sh --system-prompt-file ~/.claude/system-prompts/sysadmin-agent-system-prompt.md -- "/ops-sysadmin-agent"
