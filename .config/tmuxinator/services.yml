name: services
root: ~/.claude
on_project_start:
  - tmux bind-key d display-popup -E -w 50 -h 8 "~/.claude/dashboards/claude-dashboard-swap.sh"

# Custom user services (regular files in ~/.config/systemd/user/)
# Excludes: pueued, system-provided (at-spi, evolution, org.gnome, dconf)

<%
  exclude = %w[pueued at-spi dconf evolution org.gnome]
  services = Dir.glob(File.expand_path("~/.config/systemd/user/*.service"))
    .map { |f| File.basename(f, ".service") }
    .reject { |s| exclude.any? { |e| s.start_with?(e) } }
    .sort
%>

windows:
  - dashboard:
      layout: main-horizontal
      panes:
        - while true; do sampler -c "${HOME}/.claude-dashboard-active.yml" 2>/dev/null || sampler -c "${HOME}/.claude/dashboards/claude-dashboard-services.yml"; sleep 1; done
  - sysadmin:
      panes:
        - __claude_with_monitor.sh --system-prompt-file ~/.claude/system-prompts/sysadmin-agent-system-prompt.md -- "/ops-sysadmin-agent"
